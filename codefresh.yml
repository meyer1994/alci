version: '1.0'

steps:
  clone:
    type: git-clone
    repo: 'meyer1994/alci'

  build:
    type: freestyle
    working_directory: ./alci
    commands:
      - pip install -r requirements.txt
      - python main.py
      - flake8 --statistics *.py
      - coverage run --source=main -m unittest -vb test.py
      - coverage report -m
    matrix:
      image:
        - python:3.6-alpine
        - python:3.7-alpine
        - python:3.8-alpine

  deploy:
    type: freestyle
    image: alpine
    working_directory: ./alci
    commands:
      - apk add zip
      - zip pack.zip *.py
